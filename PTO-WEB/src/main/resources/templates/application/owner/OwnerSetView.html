<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/efileApplicationAttorneyFragment :: layout (~{::body},'user')}" xmlns="http://www.w3.org/1999/html">
<head >
    <meta charset="UTF-8">
    <title>Owner Information</title>
</head>
<body>

<!-- End Navbar -->
<div class="row content" id="attorney" style="display: none;">
    <main class="col-xs-12 col-sm-8 col-md-8 col-lg-7">

        <!--START Content Div-->
        <div class="row">
            <div class="col-xs-12">
                <div class="row">
                    <section class="col-xs-12 steps breadcrumb-steps" aria-label="progress tracker">
                        <div class="row displaycell">
                            <div class="col-xs-2 one" id="bs-header1">
                                <div class="row">
                                    <div class="col-xs-3 col-sm-5 col-md-4 col-lg-4 number">
                                        <span>1</span>
                                    </div>
                                    <div class="col-xs-9 col-sm-7 col-md-8 col-lg-8" id="bs-link1">
                                        <p class="first">Your details</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-2 two" id="bs-header2">
                                <div class="row">
                                    <div class="col-xs-3 col-sm-5 col-md-4 col-lg-4 number">
                                        <span>2</span>
                                    </div>
                                    <div class="col-xs-9 col-sm-7 col-md-8 col-lg-8" id="bs-link2">
                                        <p>Trademark details</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-2 three" id="bs-header3">
                                <div class="row">
                                    <div class="col-xs-3 col-sm-5 col-md-4 col-lg-4 number">
                                        <span>3</span>
                                    </div>
                                    <div class="col-xs-9 col-sm-7 col-md-8 col-lg-8" id="bs-link3">
                                        <p>Goods and services</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-2 four" id="bs-header4">
                                <div class="row">
                                    <div class="col-xs-3 col-sm-5 col-md-4 col-lg-4 number">
                                        <span>4</span>
                                    </div>
                                    <div class="col-xs-9 col-sm-7 col-md-8 col-lg-8" id="bs-link4">
                                        <p>Basis</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-2 five" id="bs-header5">
                                <div class="row">
                                    <div class="col-xs-3 col-sm-5 col-md-4 col-lg-4 number">
                                        <span>5</span>
                                    </div>
                                    <div class="col-xs-9 col-sm-7 col-md-8 col-lg-8" id="bs-link5">
                                        <p>Additional info</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-2 six" id="bs-header6">
                                <div class="row">
                                    <div class="col-xs-3 col-sm-5 col-md-4 col-lg-4 number">
                                        <span>6</span>
                                    </div>
                                    <div class="col-xs-9 col-sm-7 col-md-8 col-lg-8" id="bs-link6">
                                        <p>Confirm and pay</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <h1>Owner Information</h1>
                    </div>


                </div>

                <!--START Attorney Information Form-->



                    <div class="row" style="">

                        <div class="col-sm-4">
                            <h5><b>Trademark Application Owner Details</b></h5>
                        </div>

                        <div class="col-sm-3">
                        </div>
                        <div class="col-sm-3">
                        </div>

                        <div class="col-sm-3" style="position: relative; top: -10px; float: right; ">
                            <span id="addOwneronfirm" class=" btn-sm btn"  type="button"  style=" padding:5px; max-width: 170px; padding:5px;  color: white; background-color: rgb(52, 152, 219); border-bottom-left-radius: 5px; border-bottom-right-radius: 5px; border-top-right-radius: 5px; border-top-left-radius: 5px;  position: relative;top:20px;"><i class="material-icons" style="position: relative; left: -10px;">person_add</i><b style="position: relative; top:-5px;"><a id="addOwnerLink" style="color: white; text-decoration: none;" >Add<br> Additional Owner</a></b></span>
                        </div>

                    </div>

                    <div class="accordion" id="accordionExample" style="position: relative; right:-10px; margin-top: 30px; word-wrap:break-word;">


                        <!--only one owner to display -->
                        <!--item 1 -->
                        <th:block th:each="owner : ${baseTrademarkApplication.owners}">
                            <div class="card" id="contact" style=" background-color: white; ">
                                <div class="card-header" id="headingTwo"  style="background-color: white;">
                                    <div class="row">
                                        <div class="col-sm-1">
                                            <i class="material-icons" style="position: relative; bottom: -5px;">contacts</i>

                                        </div>
                                        <div class="col-sm-1">
                                            <i class="material-icons collapsed" data-toggle="collapse" th:attr="data-target='#'+${owner.id}"   aria-expanded="false" aria-controls="collapseTwo" style="position: relative; bottom:-5px; left:-20px;">keyboard_arrow_right</i>
                                        </div>
                                        <div class="col-sm-2 col-sm-3 col-sm-4">
                                            <div class="row">
                                                <b style="position: relative;" th:text="${owner.ownerDisplayname}">Owner Name</b>
                                            </div>

                                        </div>

                                        <div class="col-sm-3 col-sm-4 col-sm-5" style="position: relative ">
                                            <b style="position: relative;  " th:text="${owner.email}"> Attorney@Email.com</b>
                                        </div>

                                        <div class="col-sm-2 col-sm-3 col-sm-4">
                                               <b style="position: relative;" th:text="${owner.getOwnersubType()}"> Attorney Firm, LLC </b>
                                        </div>


                                        <div class="col-sm-1" style="position: relative; margin-left:8%"   >
                                            <button th:attr="contact-email=${owner.email}" type="button" class="close btn remove-owner"  aria-label="Close" style="position: relative; bottom: -9px;"><span class="glyphicon glyphicon-remove" aria-hidden="true" style=""></span></button>
                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div th:attr="id=${owner.id}"  class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample" style="margin-bottom: 10px;">
                                <div class="card-body">

                                    <div class="row" style="position: relative;  margin-top: 10px; margin-left: 5%;">
                                        <span class="collapsed"  data-toggle="collapse" th:attr="data-target='#'+${owner.id}+'a'"  aria-expanded="false" aria-controls="collapseTwoAddress">
                                            <i class="material-icons">keyboard_arrow_right</i><b style="position: relative; top:-7px;"> Address</b>
                                        </span>

                                        <div th:attr="id=${owner.id}+'a'"  class="collapse" aria-labelledby="headingTwoAddress" data-parent="#accordionExample" >
                                            <div class="card-body" style="max-width: 85%;">

                                                <span style="position: relative; right:-30px;" th:text="${owner.address}+' '+${owner.city}+', '+${owner.state}+' '+${owner.zipcode}"> 1115 Reserve Champion Drive, Rockville MD 20850</span>

                                            </div>
                                        </div>
                                    </div>

                                    <div class="row" style="position: relative; margin-top: 10px; margin-left: 5%;">
                                            <span class="collapsed"  data-toggle="collapse" th:attr="data-target='#'+${owner.id}+'b'"  aria-expanded="false" aria-controls="collapseTwoAffiliation">
                                                <i class="material-icons">keyboard_arrow_right</i> <b style="position: relative; top:-7px;">Website URL</b>
                                            </span>

                                        <div th:attr="id=${owner.id}+'b'"  class="collapse" aria-labelledby="headingTwoAffiliation" data-parent="#accordionExample" >
                                            <div class="card-body" style="max-width: 85%;">

                                                <span style="position: relative; right:-30px;"  th:text="${owner.webSiteURL}">Washington Dc Bar Association. Maryland Bar Association.</span>

                                            </div>
                                        </div>
                                    </div>

                                    <th:block th:each="governingEntity : ${owner.governingEntities}">
                                        <div class="row" style="position: relative; margin-top: 10px; margin-left: 5%;">
                                                <span class="collapsed"  data-toggle="collapse" th:attr="data-target='#'+${owner.id}+${governingEntity.collapseID}+'c'"  aria-expanded="false" aria-controls="collapseTwoAffiliation">
                                                    <i class="material-icons">keyboard_arrow_right</i> <b style="position: relative; top:-7px;">Partner Info</b>
                                                </span>

                                            <div th:attr="id=${owner.id}+${governingEntity.collapseID}+'c'"  class="collapse" aria-labelledby="headingTwoAffiliation" data-parent="#accordionExample" style="max-width: 850px;">
                                                <div class="card-body" style="max-width: 85%;" >
                                                    <span>Partner name:</span>
                                                    <span style="position: relative; right:-30px;"  th:text="${governingEntity.displayName}">Washington Dc Bar Association. Maryland Bar Association.</span><br>
                                                    <span>Partner Type:</span>
                                                    <span style="position: relative; right:-30px;"  th:text="${governingEntity.entityType}">Washington Dc Bar Association. Maryland Bar Association.</span><br>
                                                    <span>Partner State of Organization or Incorporation:</span>
                                                    <span style="position: relative; right:-30px;"  th:text="${governingEntity.organizationState}">Washington Dc Bar Association. Maryland Bar Association.</span><br>
                                                    <span>Partner Country:</span>
                                                    <span style="position: relative; right:-30px;"  th:text="${governingEntity.organizationCountry}">Washington Dc Bar Association. Maryland Bar Association.</span><br>

                                                </div>
                                            </div>
                                        </div>
                                    </th:block>

                                    <div class="row" style="position: relative; margin-left: 9%; margin-top: 10px;">
                                        <b>Phone Number:</b> <span  th:text="${owner.primaryPhonenumber}" > </span>

                                    </div>

                                </div> <!-- end of outter card body -->
                            </div> <!--end of collapse two -->

                            <!-- end of item 1 -->



                        </th:block>



                    </div> <!~- end of accordian -->



            </div>
        </div>

        <div class="inlinebuttons btn-group btn-group-justified  owner-paging-buttons" role="nav" aria-label="view previous or next page" id="prevnxt">
            <div class="btn-group">
                <button type="button" class="btn btn-sm btn-default fill prev" id="prevButton" value="previous">Previous</button>
            </div>
            <div class="btn-group">
                <button type="button" class="btn btn-sm btn-primary fill next" id="nextButton" value="next">Next
                    <div class="round"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span></div></button>
            </div>
        </div>

    </main>
    <!-- end of main content-->
</div>
<div class="container-fluid stickycomponents">
    <div id="chats">
        <div class="row">

            <section class="col-xs-7 col-sm-6 col-md-6 col-lg-6 col-xs-offset-5 col-sm-offset-6 col-md-offset-6 col-lg-offset-6 weight600" aria-label="your data" id="mydata2">
                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" id="contacts">
                            <h4 class="panel-title">
                                <button type="button" class="btn btn-link Accordion-trigger" data-toggle="collapse" data-target="#collapse2" aria-controls="collapse2" aria-expanded="false" id="contactsbtn" aria-label="toggle contacts panel"><span id="toggleglyphone" class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span><span id="toggleglyph" class="glyphicon glyphicon-triangle-top visuallyremoved" aria-hidden="true"></span>Contacts</button>
                            </h4>
                            <button type="button" id="closecontacts" class="close" data-target="#mydata2" aria-label="Close"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                        </div>
                        <div id="collapse2" class="panel-collapse collapse" aria-labelledby="contactsbtn">
                            <table class="list-group table">
                                <tr class="row">
                                    <td class="list-group-item col-xs-6"><a href="#" class="fromcontact" id="clearform">Clear Form</a></td>
                                    <td class="list-group-item inner-addon right-addon col-xs-6"><i class="glyphicon glyphicon-search" aria-hidden="true"></i><input type="text" class="form-control" id="contactsearch" placeholder="" aria-label="search"></td>
                                </tr>



                                <th:block th:each="contact : ${user.getOwnerManagedContact()}">

                                    <tr class="row">
                                        <td class="list-group-item col-xs-6"><a href="#" class="fromcontact" id="managedContactFillFormAction" ><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span><span class="glyphicon glyphicon-ok-sign visuallyremoved" aria-hidden="true"></span></a> <b th:text="${contact.displayName}">Avo Reed</b></td>
                                        <td class="list-group-item col-xs-6" th:text="${contact.email}">avo.reid@us.gt.com</td>
                                    </tr>

                                </th:block>
                            </table>
                        </div>
                    </div>
                </div><!--END contacts-->
            </section>
        </div><!--END row-->
    </div><!--END chats-->
</div><!--END div container-fluid-->















    <!--load data from model -->

    <!--load model attribute for Jquery consumption  -->
    <script th:inline="javascript">

        /*<![CDATA[*/


        var appInternalID = /*[[${baseTrademarkApplication.applicationInternalID}]]*/ 'User Name';
        var ownerPoolSize = /*[[${baseTrademarkApplication.owners.size()}]]*/ 'User Name';

        var host_name= /*[[${hostBean.host}]]*/ 'User Name';
        var host_port= /*[[${hostBean.port}]]*/ 'User Name';
        var host = host_name+":"+host_port;
        var contactNames = /*[[${myManagedContacts.ContactNames}]]*/ 'User Name';
        var selectedContactNames = /*[[${selectedOwners.ContactNames}]]*/ 'User Name';

        var breadCrumbStatus = /*[[${breadCrumbStatus}]]*/ 'User Name';

        /*]]>*/
    </script>



    <script>

        var prevLinkURL = "../../application/OwnerStart/?trademarkID="+appInternalID;
        var nextLinkURL = "../../application/MarkDetails/?trademarkID="+appInternalID;
        var newOwnerLink = "../../owner/entity/?trademarkID="+appInternalID;


        // bread crumb links
        // tab 1 application_start_id
        ////////////////////////////////////////////////////////////////////////////////////
        // bred crumb links
        ////////////////////////////////////////////////////////////////////////////////////
        var bsLink1 = "../../application/OwnerSetView/?trademarkID="+appInternalID;

        var bsLink2_active =  "../../application/MarkDetails/?trademarkID="+appInternalID;
        var bsLink2_done =  "../../mark/designWithTextDisclaimer/?trademarkID="+appInternalID;

        var bsLink3_active =  "../../application/goodsAndServicesStart/?trademarkID="+appInternalID;
        var bsLink3_done =  "../../application/goodsAndServicesReview/?trademarkID="+appInternalID;




        var bsLink4_active = "../../application/filingBasisStart/?trademarkID="+appInternalID;
        var bsLink4_done = "../../application/filingBasisStart/?trademarkID="+appInternalID;



        var bsLink5_active =  "../../application/additionalInfoUpload/?trademarkID="+appInternalID;
        var bsLink5_done =  "../../application/additionalInfoUpload/?trademarkID="+appInternalID;




        var bsLink6_active =  "../../application/confirmInfo/?trademarkID="+appInternalID;
        var bsLink6_done =  "../../application/confirmInfo/?trademarkID="+appInternalID;
        ////////////////////////////////////////////////////////////////////////////////////



    </script>

    <!--load model attribute for Jquery consumption  -->
    <script th:inline="javascript">


    </script>

    <script>
        $(document).ready(function() {

            setTimeout(function() {
                // after 1000 ms we add the class animated to the login/register card
                $('.content').fadeIn(500);
            }, 500);

            setTimeout(function() {
                // after 1000 ms we add the class animated to the login/register card
                $('#contacts-ui').fadeIn(500);
            }, 500);

            setTimeout(function() {
                // after 1000 ms we add the class animated to the login/register card
                $('#widget-UI').fadeIn(500);
            }, 500);

            ////////////////////////////////////////
            // set link click events
            /////////////////////////////////////////

            $('#prevButton').click(function () {
                location.href=prevLinkURL;
            });

            $('#nextButton').click(function () {
                location.href=nextLinkURL;
            });


            $('.glyphicon-remove').click();

            setBreadCrumb(breadCrumbStatus);

            $('#bs-link1').click(function () {
                var url = $(this).attr("href");
                if(url != "undefined"){
                    //location.href=url;
                }

            });

            $('#bs-link2').click(function () {
                var url = $(this).attr("href");
                if(url != "undefined"){
                    location.href=url;
                }

            });

            $('#bs-link3').click(function () {
                var url = $(this).attr("href");
                if(url != "undefined"){
                    location.href=url;
                }

            });

            $('#bs-link4').click(function () {
                var url = $(this).attr("href");
                if(url != "undefined"){
                    location.href=url;
                }

            });

            $('#bs-link5').click(function () {
                var url = $(this).attr("href");
                if(url != "undefined"){
                    location.href=url;
                }

            });

            $('#bs-link6').click(function () {
                var url = $(this).attr("href");
                if(url != "undefined"){
                    location.href=url;
                }

            });




            /////////////////////////////////////////////////
            // check each radio button in accordian..
            // if any is checked .. enable confirm and next buttons
            /////////////////////////////////////////////////
            $('#accordionExample input').each(function () {
                //alert("##############")
                if($(this).is(':checked')){
                    // alert("!!!!!!!!!!!!!!!!")
                    // confirm link only activated oin new primary set
                    $('.next-button').css("background-color", "rgb(55, 69, 120)");
                    $('#nextLink').attr("href", nextLinkURL);


                }

            });




            $('#accordionExample').on('click', 'input.primaryLawyer', function () {

                var field_value =  $(this).parent().next().next().next().children().html();


                if(field_value != "") {
                    // set email to confirm button property
                    $('#confirm-link-widget').attr("primary-attorney-email", field_value);

                }
                enableConfirmWidgetLink();
            });
            $('#confirm-link-widget').click( function () {
                // alert("!!!!!!!!!!!!!");
                //alert($(this).attr("primary-attorney-email"));
                var contact_email = $(this).attr("primary-attorney-email");
                setPrimaryAttorneyApplication(contact_email, appInternalID);
                // enable next link ..
                // enable next url ...
                $('#nextLink').attr("href", nextLinkURL);
                $('#next-link-application').css("background-color", "rgb(55, 69, 120)");



            });



            // set add owner link

            $('#addOwnerLink').prop("href", prevLinkURL);


            /////////////////////////////////////////////////////////////////////////
            /////////////////////////////////////////////////////////////////////////


            /////////////////////////////////////////////////////////////////////////
            // add new owner
            /////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////
            // load correspoinding owner form into modal on open
            ////////////////////////////////////////////////////////////////
            $('#addNewOwnerModal').on('shown.bs.modal', function () {

                $.post(newOwnerLink, function(data){

                    $("#addNewOwnerModalBody").html(data).fadeIn();

                });

            });


            $('#addNewOwnerModal').on('hidden.bs.modal', function () {

                // clean up dynamically loaded html
                $("#addNewOwnerModalBody").html("").fadeIn();

                $("#ownerEntityForm").html("").fadeIn();

            });



            // all text notification should go away by itself

            /////////////////////////////////////////////////////////////////////////////

            // sort and redraw to line up columns
            $('[data-toggle="tooltip"]').tooltip();
            // sort and redraw to line up columns



            // remove owner - hide and auto save
            $('.remove-owner').click(function () {
                //alert($(this).parent().parent().parent().html());
                $(this).parent().parent().parent().fadeOut(500);
                $(this).parent().parent().parent().parent().next().fadeOut(500);
                var contactEmail = $(this).attr("contact-email");
                //alert(contactEmail);
                // make call to remove attorney from application
                removeOwnerFromApplication(contactEmail,appInternalID);

                if(ownerPoolSize == 1){
                    $('#nextButton').attr("disabled", true);

                }
                ownerPoolSize--;


            });





        });  // end of document ready ()
        /////////////////////////////////////////////////////
        // aJAX
        /////////////////////////////////////////////////////

        function removeOwnerFromApplication(contact_email, project_ID) {

            //////////////////////////////////////////////////////////////////////////////////////
            // we need REST controller of finding a contact by its email
            // this needs to be implemented on the PTOUser object
            //////////////////////////////////////////////////////////////////////////////////////
            var contact_field_name = "application-contact-add-confirm";
            $.ajax({
                //url: host+"/REST/apiGateway/application/update/"+field_name_prefix+"/"+field_value+"/"+applicaiton_internal_id,
                url: "../../REST/apiGateway/application/contacts/owner/delete/"+contact_email+"/"+project_ID,

                type: 'GET',
                success: function(data){



                    // parse out status msg:
                    var s_code = data.substring(data.indexOf("status:")+7, data.indexOf("status:")+4+7);

                    var s_msg = data.substring(data.indexOf("msg:")+4, data.length-2);

                    if(s_code.trim() == "200"){
                        //if(data.contains("status: 200")){
                        // show confirmation check mark on form
                        //$('#toggle').delay(1000).click();
                        $(".autoSaveMessageArea span").fadeOut(500);
                        setTimeout(function() {
                            // after 1000 ms we add the class animated to the login/register card
                            $(".autoSaveMessageArea span").text(s_msg);
                            $(".autoSaveMessageArea span").fadeIn(1000);
                        }, 500);





                    }
                    else{
                        //$('.circle-loader').fadeOut(100);
                        //$('.x-mark').fadeIn(500);
                        //$(".validationMsgArea span").text(s_msg);
                        //$(".validationMsgArea span").css('color','red');
                    }

                },
                error: function(data) {

                    //$('.circle-loader').fadeOut(100);
                    //$('.x-mark').fadeIn(500);

                    console.log(data);
                    // set message to div area ...fields can not be left null
                    //$(".validationMsgArea span").text("You can not leave any fields empty.");
                    //$(".validationMsgArea span").css('color','red');
                }

            });

        } // end of function
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////




        function setBreadCrumb(bsStatusArrayList){

            for(var a=0; a< bsStatusArrayList.length; a++){
                if(a==0){
                    if(bsStatusArrayList[a] != "NA"){

                        $('#bs-header1').addClass(bsStatusArrayList[a]);

                    }

                }
                if(a==1){
                    if(bsStatusArrayList[a] != "NA"){
                        $('#bs-header2').addClass(bsStatusArrayList[a]);
                        if(bsStatusArrayList[a] == "active"){
                            $('#bs-link2').attr("href", bsLink2_active);

                        }
                        if(bsStatusArrayList[a] == "done"){
                            $('#bs-link2').attr("href", bsLink2_done);
                        }
                        //$('#bs-link2').attr("href", bsLink2);
                    }

                }
                if(a==2){
                    if(bsStatusArrayList[a] != "NA"){

                        $('#bs-header3').addClass(bsStatusArrayList[a]);
                        if(bsStatusArrayList[a] == "active"){
                            $('#bs-link3').attr("href", bsLink3_active);

                        }
                        if(bsStatusArrayList[a] == "done"){
                            $('#bs-link3').attr("href", bsLink3_done);
                        }

                    }

                }
                if(a==3){
                    if(bsStatusArrayList[a] != "NA"){

                        $('#bs-header4').addClass(bsStatusArrayList[a]);
                        if(bsStatusArrayList[a] == "active"){
                            $('#bs-link4').attr("href", bsLink4_active);

                        }
                        if(bsStatusArrayList[a] == "done"){
                            $('#bs-link4').attr("href", bsLink4_done);
                        }

                    }

                }
                if(a==4){
                    if(bsStatusArrayList[a] != "NA"){
                        $('#bs-header5').addClass(bsStatusArrayList[a]);
                        if(bsStatusArrayList[a] == "active"){
                            $('#bs-link5').attr("href", bsLink5_active);

                        }
                        if(bsStatusArrayList[a] == "done"){
                            $('#bs-link5').attr("href", bsLink5_done);
                        }

                    }

                }
                if(a==5){
                    if(bsStatusArrayList[a] != "NA"){
                        $('#bs-header6').addClass(bsStatusArrayList[a]);
                        if(bsStatusArrayList[a] == "active"){
                            $('#bs-link6').attr("href", bsLink6_active);

                        }
                        if(bsStatusArrayList[a] == "done"){
                            $('#bs-link6').attr("href", bsLink6_done);
                        }

                    }

                }

            }

        }




    </script>

</body>
</html>